if cpuid -l; then
    havekernel="Y"
    title=""
    for kopt in @arch@ $kopts artixbasedir=@iso_name@ artixlabel=@iso_label@ @kernel_args@ check; do
        if [ -n "$title" ] ; then
            title="$title $kopt";
        else
            title="$kopt";
        fi;
    done
    menuentry "From CD/DVD/ISO: @iso_name@.@arch@ " --class=@iso_name@.@arch@ "$title" {# set arguments above with the editor
        linux /boot/vmlinuz-$2
        initrd /boot/initramfs-@arch@.img
    }
    menuentry "From Stick/HDD: @iso_name@.@arch@ " --class=@iso_name@.@arch@ "$title fromhd" {# set arguments above with the editor
        linux /boot/vmlinuz-$2
        initrd /boot/initramfs-@arch@.img
    }
fi
if [ "${havekernel}" != "Y" ]; then
    menuentry --class=find.none "NO SUITABLE KERNELS AVAILABLE" {echo $@  echo "There are no kernels suitable for this machine available."
        echo ""
        if ! cpuid -l; then
            echo "This machine is NOT 64bit capable."
            for kk in /boot/vmlinu*@arch@; do
                if [ "$kk" != "/boot/vmlinu*@arch@" ]; then
                    have32="true"
                fi
            done
            if [ "${have32}" != "true" ]; then
                echo "There are no 32bit kernels available"
                echo "It appears you are trying to boot a 64bit release on a 32bit machine"
                echo "This cannot work!"
            fi
        fi
        echo "Press Escape to return to the main menu"
        sleep --interruptible 9999
        menu_reload
    }
fi
